openapi: 3.0.0
info:
  title: Educate Global Hub API
  version: 1.0.0
  description: |
    Full API documentation for Teacher Profile management, including per-section CRUD for
    Employment, Education, Qualifications, Referees, Certifications, Professional Development,
    and Memberships. All protected routes require a Bearer JWT token.
servers:
  - url: http://localhost:5000/api/v1
    description: Local development server
  - url: https://educate-global-hub-node-production.up.railway.app/api/v1
    description: Production server (Railway)

tags:
  - name: Health
    description: API health and status
  - name: Authentication
    description: User authentication and authorization
  - name: Users
    description: User management operations
  - name: TeacherProfile
    description: Core teacher profile create/read/update and search
  - name: Employment
    description: Employment history CRUD
  - name: Education
    description: Education history CRUD
  - name: Qualifications
    description: Qualifications & certifications (teacher-level)
  - name: Referees
    description: Professional referees CRUD
  - name: Certifications
    description: Professional certifications (separate collection)
  - name: Development
    description: Professional development (courses, workshops)
  - name: Memberships
    description: Professional memberships and associations
  - name: Jobs
    description: Job recommendations
  - name: Dependents
    description: Teacher dependents (family members)
  - name: Activities
    description: Extracurricular activities
  - name: Jobs
    description: Job management and applications
  - name: Applications
    description: Job application management
  - name: SavedJobs
    description: Teacher saved jobs management
  - name: SchoolProfiles
    description: School profile management
  - name: Uploads
    description: File upload management
  - name: Notifications
    description: User notification management
paths:
  #################################################################
  # Health Check
  #################################################################
  /health:
    get:
      tags: [Health]
      summary: API health check
      description: Returns the current status of the API
      responses:
        "200":
          description: API is running
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean }
                  message: { type: string }
                  timestamp: { type: string, format: date-time }
                  environment: { type: string }

  #################################################################
  # Authentication
  #################################################################
  /auth/signup:
    post:
      tags: [Authentication]
      summary: Register a new user
      description: Creates a new user account with email verification
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SignupRequest"
            example:
              firstName: "John"
              lastName: "Doe"
              email: "john.doe@example.com"
              password: "SecurePassword123!"
              role: "teacher"
      responses:
        "201":
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "409":
          description: User already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/login:
    post:
      tags: [Authentication]
      summary: Authenticate user and get token
      description: Login with email and password to receive access and refresh tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
            example:
              email: "john.doe@example.com"
              password: "SecurePassword123!"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "401":
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/send-otp:
    post:
      tags: [Authentication]
      summary: Send OTP for email verification or password reset
      description: Sends a one-time password to the user's email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SendOTPRequest"
            example:
              email: "john.doe@example.com"
              purpose: "email_verification"
      responses:
        "200":
          description: OTP sent successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OTPResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

  /auth/verify-otp:
    post:
      tags: [Authentication]
      summary: Verify OTP and mark email as verified
      description: Verifies the OTP code and marks the user's email as verified
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VerifyOTPRequest"
            example:
              email: "john.doe@example.com"
              otp: "123456"
              purpose: "email_verification"
      responses:
        "200":
          description: OTP verified successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OTPVerificationResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

  /auth/password-reset:
    post:
      tags: [Authentication]
      summary: Send password reset email
      description: Initiates password reset process by sending OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PasswordResetRequest"
            example:
              email: "john.doe@example.com"
      responses:
        "200":
          description: Password reset email sent
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PasswordResetResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

  /auth/password-reset-confirm:
    post:
      tags: [Authentication]
      summary: Reset password with OTP
      description: Confirms password reset using OTP and sets new password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PasswordResetConfirmRequest"
            example:
              email: "john.doe@example.com"
              otp: "123456"
              newPassword: "NewSecurePassword123!"
      responses:
        "200":
          description: Password reset successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PasswordResetConfirmResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

  /auth/refresh:
    post:
      tags: [Authentication]
      summary: Refresh access token
      description: Uses refresh token to get a new access token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenRequest"
            example:
              refreshToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        "200":
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefreshTokenResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /auth/logout:
    post:
      tags: [Authentication]
      summary: Logout user
      description: Invalidates the refresh token and logs out the user
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LogoutRequest"
            example:
              refreshToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        "200":
          description: Logout successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LogoutResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /auth/me:
    get:
      tags: [Authentication]
      summary: Get current user
      description: Returns the authenticated user's information
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Current user information
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CurrentUserResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  #################################################################
  # User Management
  #################################################################
  /users/complete-profile:
    post:
      tags: [Users]
      summary: Complete user profile
      description: Completes the user profile with additional information
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CompleteProfileRequest"
      responses:
        "200":
          description: Profile completed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfileResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /users/profile:
    get:
      tags: [Users]
      summary: Get current user profile
      description: Returns the authenticated user's complete profile
      security:
        - bearerAuth: []
      responses:
        "200":
          description: User profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfileResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
    put:
      tags: [Users]
      summary: Update user profile
      description: Updates the authenticated user's profile information
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateProfileRequest"
      responses:
        "200":
          description: Profile updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfileResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /users/{id}:
    get:
      tags: [Users]
      summary: Get public user profile by ID
      description: Returns public information about a user
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
          description: User ID
      responses:
        "200":
          description: Public user profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PublicUserProfileResponse"
        "404":
          $ref: "#/components/responses/NotFound"

  /users:
    get:
      tags: [Users]
      summary: Get users list with filtering and pagination
      description: Returns a paginated list of users with optional filtering
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
          description: Page number
        - in: query
          name: limit
          schema: { type: integer, default: 10 }
          description: Page size
        - in: query
          name: role
          schema: { type: string }
          description: Filter by user role
        - in: query
          name: search
          schema: { type: string }
          description: Search by name or email
      responses:
        "200":
          description: Paginated users list
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UsersListResponse"

  /users/avatar:
    put:
      tags: [Users]
      summary: Update user avatar
      description: Updates the authenticated user's avatar image
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                avatar:
                  type: string
                  format: binary
                  description: Avatar image file
      responses:
        "200":
          description: Avatar updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AvatarUpdateResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /users/account:
    delete:
      tags: [Users]
      summary: Delete user account
      description: Permanently deletes the authenticated user's account
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Account deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccountDeleteResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  #################################################################
  # Teacher profile (core)
  #################################################################
  /teacher-profiles:
    post:
      tags: [TeacherProfile]
      summary: Create or update the current user's teacher profile
      description: Creates a new TeacherProfile if none exists for the authenticated user, or updates the existing profile. This endpoint accepts the core (non-repeatable) fields. Repeatable sections (employment, education, qualifications, referees, certifications, development, memberships) have their own endpoints.
      security:
        - bearerAuth: []
      requestBody:
        description: Core profile fields. Use the per-section endpoints to add lists (employment, education, qualifications etc.)
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TeacherProfileRequest"
            example:
              fullName: "Sarah Johnson"
              phoneNumber: "+1-555-123-4567"
              country: "United States"
              city: "Boston"
              province: "Massachusetts"
              zipCode: "02101"
              address: "123 Maple Street"
              qualification: "Master"
              subject: "Mathematics"
              pgce: true
              yearsOfTeachingExperience: 6
              professionalBio: "Mathematics teacher with a passion for student-centred learning."
              keyAchievements:
                - "Led department curriculum update (2022)"
                - "Published article on differentiated assessment"
      responses:
        "200":
          description: Profile created or updated successfully (returns aggregated profile)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TeacherProfileResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /teacher-profiles/me:
    get:
      tags: [TeacherProfile]
      summary: Get the authenticated teacher's full aggregated profile
      description: Returns the profile document plus all related sections (employment, education, qualifications, referees, certifications, development, memberships). Requires authentication.
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Aggregated teacher profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TeacherProfileResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /teacher-profiles/{teacherId}:
    get:
      tags: [TeacherProfile]
      summary: Get public teacher profile by user id
      description: Public view â€” sensitive fields such as exact phone number and full address are intentionally omitted. Includes non-sensitive sections (education, qualifications, employment summaries). Use this for public profile pages.
      parameters:
        - $ref: "#/components/parameters/teacherId"
      responses:
        "200":
          description: Public teacher profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TeacherProfilePublicResponse"
        "404":
          $ref: "#/components/responses/NotFound"

  /teacher-profiles/search:
    get:
      tags: [TeacherProfile]
      summary: Search teacher profiles
      description: Search by country, city, subject, qualification and experience range. Returns paginated results.
      parameters:
        - in: query
          name: country
          schema: { type: string }
          description: Partial or full country name (case-insensitive)
        - in: query
          name: city
          schema: { type: string }
          description: Partial or full city name
        - in: query
          name: subject
          schema: { type: string }
          description: Search by subject taught
        - in: query
          name: qualification
          schema: { type: string }
          description: Filter by qualification (e.g., Master)
        - in: query
          name: minExperience
          schema: { type: integer }
          description: Minimum years of experience
        - in: query
          name: maxExperience
          schema: { type: integer }
          description: Maximum years of experience
        - in: query
          name: page
          schema: { type: integer, default: 1 }
          description: Page number
        - in: query
          name: limit
          schema: { type: integer, default: 10 }
          description: Page size
      responses:
        "200":
          description: Paginated list of teacher profiles (public-safe view)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedTeacherProfilePublicResponse"

  /teacher-profiles/me/recommended-jobs:
    get:
      tags: [Jobs]
      summary: Get recommended jobs for the authenticated teacher
      description: Returns recommended jobs based on profile; uses services/jobRecommendationService. Accepts optional limit.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: limit
          schema: { type: integer, default: 5 }
          description: Maximum number of job results (1-20)
      responses:
        "200":
          description: List of recommended jobs
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsResponse"

  #################################################################
  # Jobs Management
  #################################################################
  /jobs:
    post:
      tags: [Jobs]
      summary: Create a new job posting
      description: Creates a new job posting (School only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateJobRequest"
      responses:
        "201":
          description: Job created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /jobs/search:
    get:
      tags: [Jobs]
      summary: Search jobs
      description: Search jobs with various filters and pagination
      parameters:
        - in: query
          name: q
          schema: { type: string }
          description: Search query
        - in: query
          name: location
          schema: { type: string }
          description: Location filter
        - in: query
          name: category
          schema: { type: string }
          description: Job category
        - in: query
          name: page
          schema: { type: integer, default: 1 }
          description: Page number
        - in: query
          name: limit
          schema: { type: integer, default: 10 }
          description: Page size
      responses:
        "200":
          description: Search results
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsSearchResponse"

  /jobs/featured:
    get:
      tags: [Jobs]
      summary: Get featured jobs
      description: Returns featured job postings
      responses:
        "200":
          description: Featured jobs
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsResponse"

  /jobs/urgent:
    get:
      tags: [Jobs]
      summary: Get urgent jobs
      description: Returns urgent job postings
      responses:
        "200":
          description: Urgent jobs
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsResponse"

  /jobs/category/{category}:
    get:
      tags: [Jobs]
      summary: Get jobs by category
      description: Returns jobs filtered by category
      parameters:
        - in: path
          name: category
          required: true
          schema: { type: string }
          description: Job category
      responses:
        "200":
          description: Jobs by category
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsResponse"

  /jobs/location/{country}/{city}:
    get:
      tags: [Jobs]
      summary: Get jobs by location
      description: Returns jobs filtered by country and city
      parameters:
        - in: path
          name: country
          required: true
          schema: { type: string }
          description: Country
        - in: path
          name: city
          required: true
          schema: { type: string }
          description: City
      responses:
        "200":
          description: Jobs by location
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsResponse"

  /jobs/{jobId}:
    get:
      tags: [Jobs]
      summary: Get job by ID
      description: Returns detailed job information
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      responses:
        "200":
          description: Job details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobDetailResponse"
        "404":
          $ref: "#/components/responses/NotFound"
    put:
      tags: [Jobs]
      summary: Update job
      description: Updates an existing job posting (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateJobRequest"
      responses:
        "200":
          description: Job updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      tags: [Jobs]
      summary: Delete job
      description: Deletes a job posting (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      responses:
        "200":
          description: Job deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/{jobId}/status:
    patch:
      tags: [Jobs]
      summary: Update job status
      description: Updates the status of a job posting (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateJobStatusRequest"
      responses:
        "200":
          description: Job status updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/{jobId}/flags:
    patch:
      tags: [Jobs]
      summary: Update job flags
      description: Updates flags for a job posting (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateJobFlagsRequest"
      responses:
        "200":
          description: Job flags updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/school/{schoolId}:
    get:
      tags: [Jobs]
      summary: Get jobs by school
      description: Returns all jobs posted by a specific school
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: schoolId
          required: true
          schema: { type: string }
          description: School ID
        - in: query
          name: page
          schema: { type: integer, default: 1 }
          description: Page number
        - in: query
          name: limit
          schema: { type: integer, default: 10 }
          description: Page size
      responses:
        "200":
          description: School jobs
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required

  /jobs/bulk/status:
    patch:
      tags: [Jobs]
      summary: Bulk update job statuses
      description: Updates status for multiple jobs (School only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkUpdateJobStatusRequest"
      responses:
        "200":
          description: Jobs updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BulkUpdateResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required

  /jobs/dashboard/school/{schoolId}:
    get:
      tags: [Jobs]
      summary: Get school dashboard stats
      description: Returns dashboard statistics for a school
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: schoolId
          required: true
          schema: { type: string }
          description: School ID
      responses:
        "200":
          description: School dashboard stats
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SchoolDashboardResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required

  /jobs/dashboard/stats:
    get:
      tags: [Jobs]
      summary: Get job statistics
      description: Returns overall job statistics
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Job statistics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobStatsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required

  #################################################################
  # Job Applications
  #################################################################
  /jobs/{jobId}/apply:
    post:
      tags: [Applications]
      summary: Apply for a job
      description: Submits a job application (Teacher only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/JobApplicationRequest"
      responses:
        "201":
          description: Application submitted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications:
    get:
      tags: [Applications]
      summary: Get application statistics
      description: Returns application statistics for the authenticated user
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Application statistics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationStatsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /jobs/applications/recent:
    get:
      tags: [Applications]
      summary: Get recent applications
      description: Returns recent applications for the authenticated user
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Recent applications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /jobs/applications/overdue:
    get:
      tags: [Applications]
      summary: Get overdue applications
      description: Returns overdue applications (School only)
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Overdue applications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required

  /jobs/applications/bulk/status:
    patch:
      tags: [Applications]
      summary: Bulk update application statuses
      description: Updates status for multiple applications (School only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkUpdateApplicationStatusRequest"
      responses:
        "200":
          description: Applications updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BulkUpdateResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required

  /jobs/{jobId}/applications:
    get:
      tags: [Applications]
      summary: Get job applications
      description: Returns applications for a specific job (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
        - in: query
          name: page
          schema: { type: integer, default: 1 }
          description: Page number
        - in: query
          name: limit
          schema: { type: integer, default: 10 }
          description: Page size
      responses:
        "200":
          description: Job applications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}:
    get:
      tags: [Applications]
      summary: Get application by ID
      description: Returns detailed application information
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      responses:
        "200":
          description: Application details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}/status:
    patch:
      tags: [Applications]
      summary: Update application status
      description: Updates the status of an application (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateApplicationStatusRequest"
      responses:
        "200":
          description: Application status updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}/withdraw:
    post:
      tags: [Applications]
      summary: Withdraw application
      description: Withdraws a job application (Teacher only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      responses:
        "200":
          description: Application withdrawn successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/teacher/{teacherId}:
    get:
      tags: [Applications]
      summary: Get applications by teacher
      description: Returns applications submitted by a specific teacher (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: teacherId
          required: true
          schema: { type: string }
          description: Teacher ID
      responses:
        "200":
          description: Teacher applications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required

  /jobs/applications/{applicationId}/interview:
    post:
      tags: [Applications]
      summary: Schedule interview
      description: Schedules an interview for an application (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ScheduleInterviewRequest"
      responses:
        "200":
          description: Interview scheduled successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}/accept:
    post:
      tags: [Applications]
      summary: Accept application
      description: Accepts a job application (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      responses:
        "200":
          description: Application accepted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}/reject:
    post:
      tags: [Applications]
      summary: Reject application
      description: Rejects a job application (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      responses:
        "200":
          description: Application rejected successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}/shortlist:
    post:
      tags: [Applications]
      summary: Shortlist application
      description: Shortlists a job application (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      responses:
        "200":
          description: Application shortlisted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}/reviewing:
    post:
      tags: [Applications]
      summary: Move application to reviewing
      description: Moves an application to reviewing status (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      responses:
        "200":
          description: Application moved to reviewing successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{applicationId}/timeline:
    get:
      tags: [Applications]
      summary: Get application timeline
      description: Returns the timeline of an application
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: applicationId
          required: true
          schema: { type: string }
          description: Application ID
      responses:
        "200":
          description: Application timeline
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApplicationTimelineResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/applications/{jobId}/export:
    get:
      tags: [Applications]
      summary: Export applications
      description: Exports applications for a job to CSV/Excel (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      responses:
        "200":
          description: Applications exported successfully
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/{jobId}/analytics:
    get:
      tags: [Jobs]
      summary: Get job analytics
      description: Returns analytics for a specific job (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      responses:
        "200":
          description: Job analytics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobAnalyticsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/{jobId}/export:
    get:
      tags: [Jobs]
      summary: Export job data
      description: Exports job data to CSV/Excel (School only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      responses:
        "200":
          description: Job data exported successfully
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - School role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/recommendations:
    get:
      tags: [Jobs]
      summary: Get job recommendations
      description: Returns personalized job recommendations for the authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Job recommendations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required

  #################################################################
  # Employment (per-section endpoints under teacher-profiles/me/)
  #################################################################
  /teacher-profiles/me/employment:
    get:
      tags: [Employment]
      summary: List employment history for authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Array of employment records
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmploymentListResponse"
    post:
      tags: [Employment]
      summary: Add an employment record for the authenticated teacher
      security:
        - bearerAuth: []
      requestBody:
        description: Employment item to add
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmploymentInput"
            example:
              jobTitle: "Mathematics Teacher"
              employer: "Lincoln High School"
              location: "Boston, MA"
              startDate: "2019-09-01"
              endDate: null
              isCurrent: true
              responsibilities:
                - "Teach Algebra I and II to 9th and 10th grade students"
                - "Design assessments aligned to standards"
              contactPerson:
                name: "Dr. Maria Rodriguez"
                position: "Principal"
                email: "mrodriguez@lincolnhs.edu"
      responses:
        "201":
          description: Employment created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmploymentResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

  /teacher-profiles/me/employment/{employmentId}:
    put:
      tags: [Employment]
      summary: Update a specific employment record
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: employmentId
          required: true
          schema: { type: string }
          description: Employment document _id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmploymentInput"
      responses:
        "200":
          description: Employment updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmploymentResponse"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      tags: [Employment]
      summary: Delete a specific employment record
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: employmentId
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Employment deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResponse"
        "404":
          $ref: "#/components/responses/NotFound"

  #################################################################
  # Education
  #################################################################
  /teacher-profiles/me/education:
    get:
      tags: [Education]
      summary: List education records for authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Array of education records
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EducationListResponse"
    post:
      tags: [Education]
      summary: Add an education record
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EducationInput"
            example:
              educationType: "University"
              degree: "Master of Education"
              institution: "Harvard University"
              fieldOfStudy: "Mathematics Education"
              gpa: "3.8/4.0"
              startDate: "2016-09-01"
              endDate: "2018-06-01"
              thesisTitle: "Impact of Technology on Math Education"
              honorsAwards:
                - "Magna Cum Laude"
      responses:
        "201":
          description: Education created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EducationResponse"

  /teacher-profiles/me/education/{educationId}:
    put:
      tags: [Education]
      summary: Update a specific education record
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: educationId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EducationInput"
      responses:
        "200":
          description: Education updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EducationResponse"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      tags: [Education]
      summary: Delete a specific education record
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: educationId
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Education deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResponse"

  #################################################################
  # Qualifications (legacy / general)
  #################################################################
  /teacher-profiles/me/qualifications:
    get:
      tags: [Qualifications]
      summary: List qualifications for authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Array of qualifications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QualificationListResponse"
    post:
      tags: [Qualifications]
      summary: Add a qualification
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/QualificationInput"
            example:
              title: "Teaching License"
              issuingInstitution: "Department of Education"
              subjectArea: "Mathematics"
              certificationId: "TL-123456"
              issueDate: "2019-06-15"
              expiryDate: "2029-06-15"
              ageRanges: ["6-11", "12-16"]
              description: "National teaching license"
      responses:
        "201":
          description: Qualification created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QualificationResponse"

  /teacher-profiles/me/qualifications/{qualificationId}:
    put:
      tags: [Qualifications]
      summary: Update a specific qualification
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: qualificationId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/QualificationInput"
      responses:
        "200":
          description: Qualification updated
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      tags: [Qualifications]
      summary: Delete a specific qualification
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: qualificationId
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Qualification deleted

  #################################################################
  # Referees
  #################################################################
  /teacher-profiles/me/referees:
    get:
      tags: [Referees]
      summary: List referees for authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Array of referees
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefereeListResponse"
    post:
      tags: [Referees]
      summary: Add a referee
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefereeInput"
            example:
              fullName: "Dr. John Smith"
              position: "Principal"
              organization: "Lincoln High School"
              email: "john.smith@school.edu"
              phone: "+1-555-987-6543"
              relationship: "Former Supervisor"
              yearsKnown: 5
              notes: "Can vouch for teaching and leadership skills"
      responses:
        "201":
          description: Referee created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefereeResponse"

  /teacher-profiles/me/referees/{refereeId}:
    put:
      tags: [Referees]
      summary: Update a referee record
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: refereeId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefereeInput"
      responses:
        "200":
          description: Referee updated
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      tags: [Referees]
      summary: Delete a referee
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: refereeId
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Referee deleted

  #################################################################
  # Certifications (new)
  #################################################################
  /teacher-profiles/me/certifications:
    get:
      tags: [Certifications]
      summary: List professional certifications for authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Array of certifications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CertificationListResponse"
    post:
      tags: [Certifications]
      summary: Add a professional certification
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CertificationInput"
            example:
              certificationName: "Certified Teacher"
              issuingOrganization: "National Board for Teaching"
              issueDate: "2021-03-15"
              expiryDate: "2026-03-15"
              credentialId: "CT-2021-0001"
              credentialUrl: "https://verify.credential.org/CT-2021-0001"
              description: "National board certification"
      responses:
        "201":
          description: Certification added
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CertificationResponse"

  /teacher-profiles/me/certifications/{id}:
    put:
      tags: [Certifications]
      summary: Update a certification
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CertificationInput"
      responses:
        "200":
          description: Certification updated
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      tags: [Certifications]
      summary: Delete a certification
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Certification deleted

  #################################################################
  # Professional Development
  #################################################################
  /teacher-profiles/me/development:
    get:
      tags: [Development]
      summary: List professional development activities for authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Array of development records
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DevelopmentListResponse"
    post:
      tags: [Development]
      summary: Add a professional development record
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DevelopmentInput"
            example:
              title: "Advanced Mathematics Pedagogy"
              provider: "Harvard Graduate School of Education"
              type: "Course"
              duration: "40 hours"
              completionDate: "2023-06-30"
              certificateUrl: "https://certificates.harvard.edu/abc"
              skillsGained:
                ["Differentiated Instruction", "Assessment Strategies"]
              impact: "Improved differentiated instruction in mixed-ability classes."
      responses:
        "201":
          description: Development record created

  /teacher-profiles/me/development/{id}:
    put:
      tags: [Development]
      summary: Update a development record
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DevelopmentInput"
      responses:
        "200":
          description: Development record updated
    delete:
      tags: [Development]
      summary: Delete a development record
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Development record deleted

  #################################################################
  # Memberships
  #################################################################
  /teacher-profiles/me/memberships:
    get:
      tags: [Memberships]
      summary: List professional memberships for authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Array of memberships
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MembershipListResponse"
    post:
      tags: [Memberships]
      summary: Add a membership
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MembershipInput"
            example:
              organizationName: "National Education Association"
              membershipType: "Full Member"
              status: "Active"
              membershipId: "NEA-2023-456789"
              joinDate: "2020-01-10"
              expiryDate: "2025-01-09"
              benefits: ["Professional Development", "Networking"]
              description: "National teacher association membership."
      responses:
        "201":
          description: Membership created

  /teacher-profiles/me/memberships/{id}:
    put:
      tags: [Memberships]
      summary: Update a membership
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MembershipInput"
      responses:
        "200":
          description: Membership updated
    delete:
      tags: [Memberships]
      summary: Delete a membership
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Membership deleted
    # ===== Dependents =====
  /teacher-additional/dependents:
    post:
      tags: [Dependents]
      summary: Add dependent
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/Dependent" }
      responses:
        "200": { description: Dependent added }
    get:
      tags: [Dependents]
      summary: Get all dependents
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: List of dependents }

  /teacher-additional/dependents/{id}:
    put:
      tags: [Dependents]
      summary: Update dependent
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/Dependent" }
      responses:
        "200": { description: Dependent updated }
    delete:
      tags: [Dependents]
      summary: Delete dependent
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        "200": { description: Dependent deleted }

  # ===== Activities =====
  /teacher-additional/activities:
    post:
      tags: [Activities]
      summary: Add extracurricular activity
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/Activity" }
      responses:
        "200": { description: Activity added }
    get:
      tags: [Activities]
      summary: Get all activities
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: List of activities }

  /teacher-additional/activities/{id}:
    put:
      tags: [Activities]
      summary: Update activity
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/Activity" }
      responses:
        "200": { description: Activity updated }
    delete:
      tags: [Activities]
      summary: Delete activity
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        "200": { description: Activity deleted }

  #################################################################
  # Saved Jobs Management
  #################################################################
  /jobs/saved:
    get:
      tags: [SavedJobs]
      summary: Get saved jobs
      description: Returns all saved jobs for the authenticated teacher
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Saved jobs list
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SavedJobsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required

  /jobs/saved/stats:
    get:
      tags: [SavedJobs]
      summary: Get saved jobs statistics
      description: Returns statistics about saved jobs
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Saved jobs statistics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SavedJobsStatsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required

  /jobs/saved/{savedJobId}:
    get:
      tags: [SavedJobs]
      summary: Get saved job by ID
      description: Returns a specific saved job
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: savedJobId
          required: true
          schema: { type: string }
          description: Saved job ID
      responses:
        "200":
          description: Saved job details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SavedJobResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required
        "404":
          $ref: "#/components/responses/NotFound"
    put:
      tags: [SavedJobs]
      summary: Update saved job
      description: Updates a saved job (Teacher only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: savedJobId
          required: true
          schema: { type: string }
          description: Saved job ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateSavedJobRequest"
      responses:
        "200":
          description: Saved job updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SavedJobResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      tags: [SavedJobs]
      summary: Remove saved job
      description: Removes a job from saved list (Teacher only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: savedJobId
          required: true
          schema: { type: string }
          description: Saved job ID
      responses:
        "200":
          description: Saved job removed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/{jobId}/save:
    post:
      tags: [SavedJobs]
      summary: Save a job
      description: Saves a job to the teacher's saved list
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SaveJobRequest"
      responses:
        "200":
          description: Job saved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SavedJobResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required
        "404":
          $ref: "#/components/responses/NotFound"

  /jobs/{jobId}/saved:
    get:
      tags: [SavedJobs]
      summary: Check if job is saved
      description: Checks if a job is saved by the authenticated teacher
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: jobId
          required: true
          schema: { type: string }
          description: Job ID
      responses:
        "200":
          description: Job saved status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobSavedStatusResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Forbidden - Teacher role required

  #################################################################
  # School Profile Management
  #################################################################
  /school-profiles:
    post:
      tags: [SchoolProfiles]
      summary: Create or update school profile
      description: Creates a new school profile or updates existing one
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SchoolProfileRequest"
      responses:
        "200":
          description: School profile created/updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SchoolProfileResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /school-profiles/me:
    get:
      tags: [SchoolProfiles]
      summary: Get current user's school profile
      description: Returns the authenticated user's school profile
      security:
        - bearerAuth: []
      responses:
        "200":
          description: School profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SchoolProfileResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /school-profiles/{schoolId}:
    get:
      tags: [SchoolProfiles]
      summary: Get school profile by ID
      description: Returns public school profile information
      parameters:
        - in: path
          name: schoolId
          required: true
          schema: { type: string }
          description: School ID
      responses:
        "200":
          description: School profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SchoolProfilePublicResponse"
        "404":
          $ref: "#/components/responses/NotFound"

  /school-profiles/search:
    get:
      tags: [SchoolProfiles]
      summary: Search school profiles
      description: Search schools with various filters
      parameters:
        - in: query
          name: q
          schema: { type: string }
          description: Search query
        - in: query
          name: country
          schema: { type: string }
          description: Country filter
        - in: query
          name: city
          schema: { type: string }
          description: City filter
        - in: query
          name: page
          schema: { type: integer, default: 1 }
          description: Page number
        - in: query
          name: limit
          schema: { type: integer, default: 10 }
          description: Page size
      responses:
        "200":
          description: Search results
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SchoolProfilesSearchResponse"

  #################################################################
  # File Upload Management
  #################################################################
  /upload/avatar:
    post:
      tags: [Uploads]
      summary: Upload user avatar
      description: Uploads a user avatar image
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                avatar:
                  type: string
                  format: binary
                  description: Avatar image file
      responses:
        "200":
          description: Avatar uploaded successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AvatarUploadResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /upload/document:
    post:
      tags: [Uploads]
      summary: Upload document
      description: Uploads a document file
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                document:
                  type: string
                  format: binary
                  description: Document file
      responses:
        "200":
          description: Document uploaded successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DocumentUploadResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /upload/{publicId}:
    delete:
      tags: [Uploads]
      summary: Delete file
      description: Deletes a file from Cloudinary
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: publicId
          required: true
          schema: { type: string }
          description: Cloudinary public ID
      responses:
        "200":
          description: File deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FileDeleteResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /upload/preset:
    get:
      tags: [Uploads]
      summary: Get upload preset
      description: Returns upload preset for client-side uploads
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Upload preset
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UploadPresetResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  #################################################################
  # Notification Management
  #################################################################
  /notifications:
    get:
      tags: [Notifications]
      summary: Get user notifications
      description: Returns user's notifications with pagination and filtering
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
          description: Page number
        - in: query
          name: limit
          schema: { type: integer, default: 20 }
          description: Page size
        - in: query
          name: isRead
          schema: { type: boolean }
          description: Filter by read status
        - in: query
          name: type
          schema: { type: string }
          description: Filter by notification type
        - in: query
          name: category
          schema: { type: string }
          description: Filter by category
        - in: query
          name: priority
          schema: { type: string }
          description: Filter by priority
        - in: query
          name: jobId
          schema: { type: string }
          description: Filter by job ID
        - in: query
          name: sortBy
          schema: { type: string, default: "createdAt" }
          description: Sort field
        - in: query
          name: sortOrder
          schema: { type: string, default: "desc" }
          description: Sort order
      responses:
        "200":
          description: Notifications list
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /notifications/stats:
    get:
      tags: [Notifications]
      summary: Get notification statistics
      description: Returns user's notification statistics
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Notification statistics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationStatsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /notifications/unread/count:
    get:
      tags: [Notifications]
      summary: Get unread notifications count
      description: Returns count of unread notifications
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Unread count
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnreadCountResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /notifications/urgent:
    get:
      tags: [Notifications]
      summary: Get urgent notifications
      description: Returns urgent notifications for user
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: limit
          schema: { type: integer, default: 10 }
          description: Maximum number of notifications
      responses:
        "200":
          description: Urgent notifications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UrgentNotificationsResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /notifications/read-all:
    put:
      tags: [Notifications]
      summary: Mark all notifications as read
      description: Marks all user's notifications as read
      security:
        - bearerAuth: []
      responses:
        "200":
          description: All notifications marked as read
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MarkAllReadResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /notifications/{id}:
    get:
      tags: [Notifications]
      summary: Get notification by ID
      description: Returns a specific notification
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
          description: Notification ID
      responses:
        "200":
          description: Notification details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /notifications/{id}/read:
    put:
      tags: [Notifications]
      summary: Mark notification as read
      description: Marks a notification as read
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
          description: Notification ID
      responses:
        "200":
          description: Notification marked as read
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /notifications/{id}/unread:
    put:
      tags: [Notifications]
      summary: Mark notification as unread
      description: Marks a notification as unread
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
          description: Notification ID
      responses:
        "200":
          description: Notification marked as unread
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /notifications/{id}:
    delete:
      tags: [Notifications]
      summary: Delete notification
      description: Deletes a specific notification
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
          description: Notification ID
      responses:
        "200":
          description: Notification deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /notifications:
    delete:
      tags: [Notifications]
      summary: Delete multiple notifications
      description: Deletes multiple notifications based on filters
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeleteNotificationsRequest"
      responses:
        "200":
          description: Notifications deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteNotificationsResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  parameters:
    teacherId:
      name: teacherId
      in: path
      required: true
      schema:
        type: string
      description: The user's id (ObjectId string)

  responses:
    BadRequest:
      description: Bad request - validation failed
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Unauthorized:
      description: Missing or invalid authentication
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  schemas:
    ### Generic responses ###
    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          description: Response payload (type varies by endpoint)

    DeleteResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: string
          description: id of deleted resource

    ErrorResponse:
      type: object
      properties:
        success: { type: boolean, example: false }
        message: { type: string }
        stack:
          type: string
          description: stack trace included only in development

    ### Teacher profile schemas ###
    TeacherProfileRequest:
      type: object
      description: Core profile fields (single-value). Use section endpoints to add arrays (employment, education, etc.)
      properties:
        fullName:
          type: string
          description: Teacher's full name (required)
        phoneNumber:
          type: string
          description: International phone format including country code (e.g., +1234567890)
        country:
          type: string
        city:
          type: string
        province:
          type: string
        zipCode:
          type: string
        address:
          type: string
          description: Postal/street address (stored in profile but hidden on public view)
        qualification:
          type: string
          enum: ["Bachelor", "Master", "PhD", "Diploma", "Certificate", "Other"]
          description: Highest / main qualification
        subject:
          type: string
        pgce:
          type: boolean
          description: Whether teacher holds PGCE (or similar teaching certificate)
        yearsOfTeachingExperience:
          type: integer
          description: Number of years teaching
        professionalBio:
          type: string
          description: Short professional biography
        keyAchievements:
          type: array
          items: { type: string }
      required:
        - fullName
        - phoneNumber
        - country
        - city
        - qualification
        - subject
        - yearsOfTeachingExperience
        - professionalBio

    UserSummary:
      type: object
      properties:
        _id: { type: string }
        email: { type: string }
        firstName: { type: string }
        lastName: { type: string }
        role: { type: string }
        avatarUrl: { type: string }

    TeacherProfile:
      type: object
      properties:
        _id: { type: string }
        userId: { type: string }
        fullName: { type: string }
        phoneNumber: { type: string }
        country: { type: string }
        city: { type: string }
        province: { type: string }
        zipCode: { type: string }
        address: { type: string }
        qualification: { type: string }
        subject: { type: string }
        pgce: { type: boolean }
        yearsOfTeachingExperience: { type: integer }
        professionalBio: { type: string }
        keyAchievements:
          type: array
          items: { type: string }
        profileCompletion:
          type: integer
          description: Percentage 0-100
        isProfileComplete:
          type: boolean
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
        user:
          $ref: "#/components/schemas/UserSummary"
        # these are included in aggregated responses:
        employment:
          type: array
          items:
            $ref: "#/components/schemas/Employment"
        education:
          type: array
          items:
            $ref: "#/components/schemas/Education"
        qualifications:
          type: array
          items:
            $ref: "#/components/schemas/Qualification"
        referees:
          type: array
          items:
            $ref: "#/components/schemas/Referee"
        certifications:
          type: array
          items:
            $ref: "#/components/schemas/Certification"
        development:
          type: array
          items:
            $ref: "#/components/schemas/Development"
        memberships:
          type: array
          items:
            $ref: "#/components/schemas/Membership"

    TeacherProfileResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/TeacherProfile"

    TeacherProfilePublicResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          description: Public-safe teacher profile (sensitive fields omitted)
          properties:
            _id: { type: string }
            fullName: { type: string }
            country: { type: string }
            city: { type: string }
            subject: { type: string }
            qualification: { type: string }
            yearsOfTeachingExperience: { type: integer }
            professionalBio: { type: string }
            employment:
              type: array
              items:
                $ref: "#/components/schemas/EmploymentPublic"

    PaginatedTeacherProfilePublicResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            data:
              type: array
              items:
                $ref: "#/components/schemas/TeacherProfilePublicResponse"
            pagination:
              type: object
              properties:
                page: { type: integer }
                limit: { type: integer }
                total: { type: integer }
                pages: { type: integer }

    #################################################################
    # Employment, Education, Qualifications, Referees,
    # Certifications, Development, Memberships, Jobs, Dependents, Activity
    #################################################################
    EmploymentInput:
      type: object
      description: Employment record to create/update. `startDate` is required.
      required: [jobTitle, employer, startDate]
      properties:
        jobTitle:
          { type: string, description: "Job title (e.g., Mathematics Teacher)" }
        employer: { type: string, description: "Employer / School name" }
        location:
          { type: string, description: "City, State or country (free text)" }
        startDate:
          { type: string, format: date, description: "Start date (YYYY-MM-DD)" }
        endDate:
          {
            type: string,
            format: date,
            nullable: true,
            description: "End date or null if current",
          }
        isCurrent:
          {
            type: boolean,
            description: "Set true if this is the current position",
          }
        responsibilities:
          type: array
          items: { type: string }
          description: "List of responsibilities / bullet points"
        contactPerson:
          type: object
          properties:
            name: { type: string }
            position: { type: string }
            email: { type: string, format: email }
    Employment:
      allOf:
        - $ref: "#/components/schemas/EmploymentInput"
        - type: object
          properties:
            _id: { type: string }
            teacherId: { type: string }
            createdAt: { type: string, format: date-time }
            updatedAt: { type: string, format: date-time }
    EmploymentPublic:
      type: object
      properties:
        jobTitle: { type: string }
        employer: { type: string }
        location: { type: string }
        startDate: { type: string, format: date }
        endDate: { type: string, format: date }
        isCurrent: { type: boolean }

    EmploymentResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/Employment"

    EmploymentListResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: array
          items:
            $ref: "#/components/schemas/Employment"

    #################################################################
    # NEW: School profile schemas
    #################################################################
    SchoolProfileRequest:
      type: object
      required:
        - schoolName
        - schoolEmail
        - schoolContactNumber
        - country
        - city
        - province
        - zipCode
        - address
        - curriculum
        - schoolSize
        - schoolType
        - genderType
        - ageGroup
        - aboutSchool
      properties:
        schoolName: { type: string }
        schoolEmail: { type: string, format: email }
        schoolContactNumber: { type: string, example: "+1234567890" }
        country: { type: string }
        city: { type: string }
        province: { type: string }
        zipCode: { type: string }
        address: { type: string }
        curriculum:
          type: array
          items:
            type: string
        schoolSize:
          type: string
        schoolType:
          type: string
        genderType:
          type: string
          format: date
          nullable: true
        credentialId:
          type: string
        credentialUrl:
          type: string
          format: uri
        description:
          type: string
    Certification:
      allOf:
        - $ref: "#/components/schemas/CertificationInput"
        - type: object
          properties:
            _id: { type: string }
            teacherId: { type: string }
            createdAt: { type: string, format: date-time }
            updatedAt: { type: string, format: date-time }
    CertificationResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/Certification"
    CertificationListResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: array
          items:
            $ref: "#/components/schemas/Certification"

    #################################################################
    # Development schemas
    #################################################################
    DevelopmentInput:
      type: object
      required: [title, provider]
      properties:
        title: { type: string, description: "Course/Workshop title" }
        provider: { type: string, description: "Providing institution" }
        type:
          type: string
          enum: ["Course", "Workshop", "Seminar", "Training", "Other"]
          default: "Course"
        duration:
          { type: string, description: "Duration text e.g., '40 hours'" }
        completionDate: { type: string, format: date }
        certificateUrl: { type: string, format: uri }
        skillsGained:
          type: array
          items: { type: string }
        impact:
          { type: string, description: "How it impacted teaching practice" }
    Development:
      allOf:
        - $ref: "#/components/schemas/DevelopmentInput"
        - type: object
          properties:
            _id: { type: string }
            teacherId: { type: string }
            createdAt: { type: string, format: date-time }
            updatedAt: { type: string, format: date-time }
    DevelopmentListResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: array
          items:
            $ref: "#/components/schemas/Development"

    #################################################################
    # Membership schemas
    #################################################################
    MembershipInput:
      type: object
      required: [programName, educationLevel, curriculum, ageRange, programDuration, classCapacity, coreSubjects, programDescription]
      properties:
        programName: { type: string, example: "International Baccalaureate Diploma" }
        educationLevel: { type: string, example: "Secondary" }
        curriculum: { type: string, example: "International Baccalaureate" }
        ageRange: { type: string, example: "16-18 years" }
        programDuration: { type: string, example: "2 years" }
        classCapacity: { type: integer, example: 25 }
        coreSubjects:
          type: array
          items: { type: string }
          example: ["Mathematics", "English", "Science"]
        programDescription: { type: string }
        admissionRequirements:
          type: array
          items: { type: string }
          example: ["Minimum GPA 3.5", "Language Proficiency"]
        programFees: { type: string, example: "$15,000/year" }

    SchoolMedia:
      type: object
      properties:
        _id: { type: string }
        title: { type: string }
        organization: { type: string }
        location: { type: string }
        publishedAt: { type: string, format: date-time }
        applicationDeadline: { type: string, format: date-time }
        salaryMin: { type: number }
        salaryMax: { type: number }
        currency: { type: string }
        salaryDisclose: { type: boolean }
        daysPosted:
          { type: integer, description: "Days since published (computed)" }
        salaryRange:
          {
            type: string,
            description: "Human readable salary range (computed)",
          }
        isExpired: { type: boolean }
    JobsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: array
          items:
            $ref: "#/components/schemas/Job"
    Dependent:
      type: object
      required:
        [
          fullName,
          relationship,
          age,
          nationality,
          passportNumber,
          passportExpiry,
        ]
      properties:
        fullName: { type: string, example: "Jane Smith" }
        relationship: { type: string, example: "Spouse" }
        age: { type: integer, example: 25 }
        nationality: { type: string, example: "American" }
        passportNumber: { type: string, example: "123456789" }
        passportExpiry: { type: string, format: date }
        visaRequired: { type: boolean, example: false }
        accommodationNeeds:
          { type: string, example: "2-bedroom apartment near school" }
        medicalNeeds: { type: string, example: "Diabetic, requires insulin" }
        educationNeeds: { type: string, example: "Primary school, Grade 3" }
        additionalNotes: { type: string, example: "Needs wheelchair access" }

    Activity:
      type: object
      required: [activityName, activityType, role, startDate, description]
      properties:
        activityName: { type: string, example: "Drama Club" }
        activityType: { type: string, example: "Club" }
        role: { type: string, example: "President" }
        organization: { type: string, example: "Community Center" }
        startDate: { type: string, format: date }
        endDate: { type: string, format: date }
        isCurrent: { type: boolean, example: true }
        timeCommitment: { type: string, example: "5 hours/week" }
        description:
          { type: string, example: "Led weekly rehearsals and managed events" }
        achievements:
          type: array
          items: { type: string }
          example: ["Leadership Award", "Best Play Regional Competition"]
        skillsDeveloped:
          type: array
          items: { type: string }
          example: ["Leadership", "Public Speaking", "Teamwork"]

    #################################################################
    # Authentication schemas
    #################################################################
    SignupRequest:
      type: object
      required: [firstName, lastName, email, password, role]
      properties:
        firstName: { type: string, example: "John" }
        lastName: { type: string, example: "Doe" }
        email: { type: string, format: email, example: "john.doe@example.com" }
        password: { type: string, minLength: 8, example: "SecurePassword123!" }
        role: { type: string, enum: ["teacher", "school"], example: "teacher" }

    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email: { type: string, format: email, example: "john.doe@example.com" }
        password: { type: string, example: "SecurePassword123!" }

    SendOTPRequest:
      type: object
      required: [email, purpose]
      properties:
        email: { type: string, format: email, example: "john.doe@example.com" }
        purpose: { type: string, enum: ["email_verification", "password_reset"], example: "email_verification" }

    VerifyOTPRequest:
      type: object
      required: [email, otp, purpose]
      properties:
        email: { type: string, format: email, example: "john.doe@example.com" }
        otp: { type: string, example: "123456" }
        purpose: { type: string, enum: ["email_verification", "password_reset"], example: "email_verification" }

    PasswordResetRequest:
      type: object
      required: [email]
      properties:
        email: { type: string, format: email, example: "john.doe@example.com" }

    PasswordResetConfirmRequest:
      type: object
      required: [email, otp, newPassword]
      properties:
        email: { type: string, format: email, example: "john.doe@example.com" }
        otp: { type: string, example: "123456" }
        newPassword: { type: string, minLength: 8, example: "NewSecurePassword123!" }

    RefreshTokenRequest:
      type: object
      required: [refreshToken]
      properties:
        refreshToken: { type: string, example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." }

    LogoutRequest:
      type: object
      required: [refreshToken]
      properties:
        refreshToken: { type: string, example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." }

    AuthResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            user:
              $ref: "#/components/schemas/UserSummary"
            accessToken: { type: string }
            refreshToken: { type: string }

    OTPResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            email: { type: string }
            purpose: { type: string }

    OTPVerificationResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            email: { type: string }
            verified: { type: boolean }

    PasswordResetResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            email: { type: string }

    PasswordResetConfirmResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            email: { type: string }
            reset: { type: boolean }

    RefreshTokenResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            accessToken: { type: string }

    LogoutResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }

    CurrentUserResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/UserSummary"

    #################################################################
    # User Management schemas
    #################################################################
    CompleteProfileRequest:
      type: object
      properties:
        firstName: { type: string, example: "John" }
        lastName: { type: string, example: "Doe" }
        phoneNumber: { type: string, example: "+1234567890" }
        dateOfBirth: { type: string, format: date, example: "1990-01-01" }
        nationality: { type: string, example: "American" }
        address: { type: string, example: "123 Main St" }
        city: { type: string, example: "New York" }
        state: { type: string, example: "NY" }
        country: { type: string, example: "USA" }
        zipCode: { type: string, example: "10001" }

    UpdateProfileRequest:
      type: object
      properties:
        firstName: { type: string, example: "John" }
        lastName: { type: string, example: "Doe" }
        phoneNumber: { type: string, example: "+1234567890" }
        dateOfBirth: { type: string, format: date, example: "1990-01-01" }
        nationality: { type: string, example: "American" }
        address: { type: string, example: "123 Main St" }
        city: { type: string, example: "New York" }
        state: { type: string, example: "NY" }
        country: { type: string, example: "USA" }
        zipCode: { type: string, example: "10001" }

    UserProfileResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/UserProfile"

    PublicUserProfileResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/PublicUserProfile"

    UsersListResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            users:
              type: array
              items:
                $ref: "#/components/schemas/PublicUserProfile"
            pagination:
              type: object
              properties:
                page: { type: integer }
                limit: { type: integer }
                total: { type: integer }
                pages: { type: integer }

    AvatarUpdateResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            avatarUrl: { type: string }

    AccountDeleteResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }

    UserProfile:
      type: object
      properties:
        _id: { type: string }
        userId: { type: string }
        firstName: { type: string }
        lastName: { type: string }
        phoneNumber: { type: string }
        dateOfBirth: { type: string, format: date }
        nationality: { type: string }
        address: { type: string }
        city: { type: string }
        state: { type: string }
        country: { type: string }
        zipCode: { type: string }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }

    PublicUserProfile:
      type: object
      properties:
        _id: { type: string }
        firstName: { type: string }
        lastName: { type: string }
        avatarUrl: { type: string }
        role: { type: string }

    #################################################################
    # Job Management schemas
    #################################################################
    CreateJobRequest:
      type: object
      required: [title, organization, location, description]
      properties:
        title: { type: string, example: "Mathematics Teacher" }
        organization: { type: string, example: "Lincoln High School" }
        location: { type: string, example: "Boston, MA" }
        description: { type: string, example: "We are seeking a qualified mathematics teacher..." }
        requirements: { type: array, items: { type: string } }
        responsibilities: { type: array, items: { type: string } }
        salaryMin: { type: number, example: 45000 }
        salaryMax: { type: number, example: 65000 }
        currency: { type: string, example: "USD" }
        salaryDisclose: { type: boolean, example: true }
        applicationDeadline: { type: string, format: date-time }
        category: { type: string, example: "Teaching" }
        type: { type: string, enum: ["Full-time", "Part-time", "Contract"], example: "Full-time" }
        experienceLevel: { type: string, example: "Mid-level" }
        educationLevel: { type: string, example: "Bachelor's" }

    UpdateJobRequest:
      type: object
      properties:
        title: { type: string }
        organization: { type: string }
        location: { type: string }
        description: { type: string }
        requirements: { type: array, items: { type: string } }
        responsibilities: { type: array, items: { type: string } }
        salaryMin: { type: number }
        salaryMax: { type: number }
        currency: { type: string }
        salaryDisclose: { type: boolean }
        applicationDeadline: { type: string, format: date-time }
        category: { type: string }
        type: { type: string, enum: ["Full-time", "Part-time", "Contract"] }
        experienceLevel: { type: string }
        educationLevel: { type: string }

    UpdateJobStatusRequest:
      type: object
      required: [status]
      properties:
        status: { type: string, enum: ["active", "paused", "closed", "draft"], example: "active" }

    UpdateJobFlagsRequest:
      type: object
      properties:
        isUrgent: { type: boolean, example: false }
        isFeatured: { type: boolean, example: false }
        isRemote: { type: boolean, example: false }

    BulkUpdateJobStatusRequest:
      type: object
      required: [jobIds, status]
      properties:
        jobIds: { type: array, items: { type: string } }
        status: { type: string, enum: ["active", "paused", "closed", "draft"] }

    JobResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/JobDetail"

    JobDetailResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/JobDetail"

    JobsSearchResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            jobs:
              type: array
              items:
                $ref: "#/components/schemas/JobDetail"
            pagination:
              type: object
              properties:
                page: { type: integer }
                limit: { type: integer }
                total: { type: integer }
                pages: { type: integer }

    JobDetail:
      allOf:
        - $ref: "#/components/schemas/Job"
        - type: object
          properties:
            description: { type: string }
            requirements: { type: array, items: { type: string } }
            responsibilities: { type: array, items: { type: string } }
            category: { type: string }
            type: { type: string }
            experienceLevel: { type: string }
            educationLevel: { type: string }
            isUrgent: { type: boolean }
            isFeatured: { type: boolean }
            isRemote: { type: boolean }
            status: { type: string }
            schoolId: { type: string }
            views: { type: integer }
            applications: { type: integer }

    SchoolDashboardResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            totalJobs: { type: integer }
            activeJobs: { type: integer }
            totalApplications: { type: integer }
            pendingApplications: { type: integer }
            recentApplications: { type: integer }

    JobStatsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            totalJobs: { type: integer }
            activeJobs: { type: integer }
            closedJobs: { type: integer }
            totalApplications: { type: integer }
            averageApplicationsPerJob: { type: number }

    BulkUpdateResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            updatedCount: { type: integer }
            failedCount: { type: integer }

    #################################################################
    # Job Application schemas
    #################################################################
    JobApplicationRequest:
      type: object
      required: [coverLetter]
      properties:
        coverLetter: { type: string, example: "I am excited to apply for this position..." }
        resumeUrl: { type: string, format: uri }
        additionalDocuments: { type: array, items: { type: string, format: uri } }
        expectedSalary: { type: number }
        availabilityDate: { type: string, format: date }
        references: { type: array, items: { type: string } }

    ApplicationResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/JobApplication"

    ApplicationsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: array
          items:
            $ref: "#/components/schemas/JobApplication"

    ApplicationStatsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            totalApplications: { type: integer }
            pendingApplications: { type: integer }
            acceptedApplications: { type: integer }
            rejectedApplications: { type: integer }
            shortlistedApplications: { type: integer }

    UpdateApplicationStatusRequest:
      type: object
      required: [status]
      properties:
        status: { type: string, enum: ["pending", "reviewing", "shortlisted", "interview", "accepted", "rejected"], example: "reviewing" }
        feedback: { type: string }
        nextStep: { type: string }

    BulkUpdateApplicationStatusRequest:
      type: object
      required: [applicationIds, status]
      properties:
        applicationIds: { type: array, items: { type: string } }
        status: { type: string, enum: ["pending", "reviewing", "shortlisted", "interview", "accepted", "rejected"] }
        feedback: { type: string }

    ScheduleInterviewRequest:
      type: object
      required: [interviewDate, interviewType]
      properties:
        interviewDate: { type: string, format: date-time }
        interviewType: { type: string, enum: ["phone", "video", "in-person"], example: "video" }
        location: { type: string }
        notes: { type: string }

    ApplicationTimelineResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: array
          items:
            type: object
            properties:
              action: { type: string }
              timestamp: { type: string, format: date-time }
              details: { type: string }

    JobApplication:
      type: object
      properties:
        _id: { type: string }
        jobId: { type: string }
        teacherId: { type: string }
        coverLetter: { type: string }
        resumeUrl: { type: string }
        additionalDocuments: { type: array, items: { type: string } }
        expectedSalary: { type: number }
        availabilityDate: { type: string, format: date }
        references: { type: array, items: { type: string } }
        status: { type: string }
        feedback: { type: string }
        interviewDate: { type: string, format: date-time }
        interviewType: { type: string }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }

    #################################################################
    # Saved Jobs schemas
    #################################################################
    SavedJobsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: array
          items:
            $ref: "#/components/schemas/SavedJob"

    SavedJobsStatsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            totalSaved: { type: integer }
            recentlySaved: { type: integer }
            appliedTo: { type: integer }

    SavedJobResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/SavedJob"

    UpdateSavedJobRequest:
      type: object
      properties:
        notes: { type: string }
        priority: { type: string, enum: ["low", "medium", "high"] }

    SaveJobRequest:
      type: object
      properties:
        notes: { type: string }
        priority: { type: string, enum: ["low", "medium", "high"] }

    JobSavedStatusResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            isSaved: { type: boolean }
            savedJobId: { type: string }

    SavedJob:
      type: object
      properties:
        _id: { type: string }
        teacherId: { type: string }
        jobId: { type: string }
        notes: { type: string }
        priority: { type: string }
        savedAt: { type: string, format: date-time }
        job:
          $ref: "#/components/schemas/JobDetail"

    #################################################################
    # School Profile schemas
    #################################################################
    SchoolProfileRequest:
      type: object
      required: [schoolName, country, city]
      properties:
        schoolName: { type: string, example: "Lincoln High School" }
        description: { type: string, example: "A prestigious high school..." }
        website: { type: string, format: uri, example: "https://lincolnhs.edu" }
        phone: { type: string, example: "+1-555-123-4567" }
        email: { type: string, format: email, example: "info@lincolnhs.edu" }
        address: { type: string, example: "123 Education Street" }
        city: { type: string, example: "Boston" }
        state: { type: string, example: "MA" }
        country: { type: string, example: "USA" }
        zipCode: { type: string, example: "02101" }
        schoolType: { type: string, enum: ["Public", "Private", "Charter", "International"], example: "Public" }
        gradeLevels: { type: array, items: { type: string }, example: ["9", "10", "11", "12"] }
        studentCount: { type: integer, example: 1200 }
        foundedYear: { type: integer, example: 1950 }
        accreditation: { type: array, items: { type: string } }
        facilities: { type: array, items: { type: string } }
        specialPrograms: { type: array, items: { type: string } }

    SchoolProfileResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/SchoolProfile"

    SchoolProfilePublicResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/SchoolProfilePublic"

    SchoolProfilesSearchResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            schools:
              type: array
              items:
                $ref: "#/components/schemas/SchoolProfilePublic"
            pagination:
              type: object
              properties:
                page: { type: integer }
                limit: { type: integer }
                total: { type: integer }
                pages: { type: integer }

    SchoolProfile:
      type: object
      properties:
        _id: { type: string }
        userId: { type: string }
        schoolName: { type: string }
        description: { type: string }
        website: { type: string }
        phone: { type: string }
        email: { type: string }
        address: { type: string }
        city: { type: string }
        state: { type: string }
        country: { type: string }
        zipCode: { type: string }
        schoolType: { type: string }
        gradeLevels: { type: array, items: { type: string } }
        studentCount: { type: integer }
        foundedYear: { type: integer }
        accreditation: { type: array, items: { type: string } }
        facilities: { type: array, items: { type: string } }
        specialPrograms: { type: array, items: { type: string } }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }

    SchoolProfilePublic:
      type: object
      properties:
        _id: { type: string }
        schoolName: { type: string }
        description: { type: string }
        website: { type: string }
        city: { type: string }
        state: { type: string }
        country: { type: string }
        schoolType: { type: string }
        gradeLevels: { type: array, items: { type: string } }
        studentCount: { type: integer }
        foundedYear: { type: integer }
        accreditation: { type: array, items: { type: string } }
        facilities: { type: array, items: { type: string } }
        specialPrograms: { type: array, items: { type: string } }

    #################################################################
    # Upload schemas
    #################################################################
    AvatarUploadResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            avatarUrl: { type: string }
            publicId: { type: string }

    DocumentUploadResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            documentUrl: { type: string }
            publicId: { type: string }
            fileName: { type: string }
            fileSize: { type: integer }

    FileDeleteResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            deleted: { type: boolean }

    UploadPresetResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            preset: { type: string }
            cloudName: { type: string }

    #################################################################
    # Notification schemas
    #################################################################
    NotificationsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            notifications:
              type: array
              items:
                $ref: "#/components/schemas/Notification"
            pagination:
              type: object
              properties:
                currentPage: { type: integer }
                totalPages: { type: integer }
                totalItems: { type: integer }
                itemsPerPage: { type: integer }
                hasNextPage: { type: boolean }
                hasPrevPage: { type: boolean }

    NotificationStatsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            stats:
              type: object
              properties:
                total: { type: integer }
                unread: { type: integer }
                urgent: { type: integer }
                today: { type: integer }
                thisWeek: { type: integer }

    UnreadCountResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            unreadCount: { type: integer }

    UrgentNotificationsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            urgentNotifications:
              type: array
              items:
                $ref: "#/components/schemas/Notification"
            count: { type: integer }

    MarkAllReadResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            message: { type: string }
            modifiedCount: { type: integer }

    NotificationResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          $ref: "#/components/schemas/Notification"

    DeleteNotificationsRequest:
      type: object
      properties:
        ids: { type: array, items: { type: string } }
        isRead: { type: boolean }
        olderThan: { type: integer }

    DeleteNotificationsResponse:
      type: object
      properties:
        success: { type: boolean }
        message: { type: string }
        data:
          type: object
          properties:
            deletedCount: { type: integer }

    Notification:
      type: object
      properties:
        _id: { type: string }
        userId: { type: string }
        type: { type: string, enum: ["application", "interview", "status_change", "reminder", "system"] }
        category: { type: string, enum: ["job", "application", "system", "reminder"] }
        priority: { type: string, enum: ["low", "medium", "high", "urgent"] }
        title: { type: string }
        message: { type: string }
        isRead: { type: boolean }
        actionRequired: { type: boolean }
        expiresAt: { type: string, format: date-time }
        jobId: { type: string }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
        hoursSinceCreated: { type: integer }
        isExpired: { type: boolean }
        isUrgent: { type: boolean }
